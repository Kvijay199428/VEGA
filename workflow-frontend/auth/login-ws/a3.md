Let’s design a Vega-style circular countdown in React — smooth, animated, and integrated with the token expiry and auto-refresh states. This will visually show remaining token time, cooldowns, and auto-refresh progress in a professional dashboard style.

We’ll use SVG + React hooks + requestAnimationFrame for smooth animation.

1. Vega-Style Circular Countdown Component
import React, { useEffect, useRef, useState } from "react";

interface CircularCountdownProps {
  totalSeconds: number;       // total token duration
  remainingSeconds: number;   // current remaining seconds
  size?: number;              // diameter of the circle
  strokeWidth?: number;       // circle thickness
  status?: "AUTH_CONFIRMED" | "RECONNECTING" | "EXPIRED"; // optional status
}

const CircularCountdown: React.FC<CircularCountdownProps> = ({
  totalSeconds,
  remainingSeconds,
  size = 80,
  strokeWidth = 8,
  status = "AUTH_CONFIRMED",
}) => {
  const [animatedSeconds, setAnimatedSeconds] = useState(remainingSeconds);
  const requestRef = useRef<number>();

  const radius = (size - strokeWidth) / 2;
  const circumference = 2 * Math.PI * radius;

  // Smooth animation using requestAnimationFrame
  useEffect(() => {
    let startTime: number | null = null;
    const animate = (timestamp: number) => {
      if (!startTime) startTime = timestamp;
      const progress = timestamp - startTime;

      // Animate remainingSeconds smoothly
      const diff = remainingSeconds - animatedSeconds;
      const step = diff * Math.min(progress / 1000, 1); // smooth step
      setAnimatedSeconds(prev => prev + step);

      if (Math.abs(diff) > 0.01) {
        requestRef.current = requestAnimationFrame(animate);
      }
    };

    requestRef.current = requestAnimationFrame(animate);

    return () => {
      if (requestRef.current) cancelAnimationFrame(requestRef.current);
    };
  }, [remainingSeconds]);

  // Circle stroke offset
  const offset = circumference * (1 - animatedSeconds / totalSeconds);

  // Dynamic color based on status
  let strokeColor = "#4caf50"; // green by default
  if (status === "EXPIRED") strokeColor = "#f44336";      // red
  if (status === "RECONNECTING") strokeColor = "#ff9800"; // orange

  return (
    <svg width={size} height={size}>
      <circle
        cx={size / 2}
        cy={size / 2}
        r={radius}
        stroke="#eee"
        strokeWidth={strokeWidth}
        fill="none"
      />
      <circle
        cx={size / 2}
        cy={size / 2}
        r={radius}
        stroke={strokeColor}
        strokeWidth={strokeWidth}
        fill="none"
        strokeDasharray={circumference}
        strokeDashoffset={offset}
        strokeLinecap="round"
        transform={`rotate(-90 ${size / 2} ${size / 2})`}
      />
      <text
        x="50%"
        y="50%"
        dominantBaseline="middle"
        textAnchor="middle"
        fontSize={size * 0.25}
        fontFamily="monospace"
        fill="#333"
      >
        {Math.ceil(animatedSeconds)}
      </text>
    </svg>
  );
};

export default CircularCountdown;

2. Integrate with AuthStatus

Use this component inside your Login or dashboard component:

import React from "react";
import useAuthStatus from "./useAuthStatus";
import CircularCountdown from "./CircularCountdown";

export default function Dashboard() {
  const status = useAuthStatus();

  if (!status) return <p>Loading...</p>;

  return (
    <div style={{ padding: 20 }}>
      <h2>Vega Token Status</h2>
      <CircularCountdown
        totalSeconds={60} // or fetch from status.totalSeconds
        remainingSeconds={status.remainingSeconds}
        status={status.state}
        size={100}
        strokeWidth={10}
      />
      <div style={{ marginTop: 10 }}>
        <p>State: {status.state}</p>
        <p>Authenticated: {status.authenticated ? "Yes" : "No"}</p>
        <p>Tokens: {status.generatedTokens}/{status.requiredTokens}</p>
      </div>
    </div>
  );
}

3. Features

Smooth animated countdown using requestAnimationFrame.

Dynamic stroke color based on token state:

Green → active

Orange → reconnecting

Red → expired

Shows remaining seconds in the center.

Easy to scale for multiple tokens, overlays, or dashboard panels.

Lightweight and HFT-friendly (SVG, no heavy libraries).

4. Optional Enhancements

Circular gradient for a more “Bloomberg-style” visual.

Pulsing effect on RECONNECTING to show auto-refresh.

Multi-token dashboard: render multiple circular countdowns for different feeds (option chain, market data, websocket).

Tooltip / hover: show exact expiry timestamp and refresh ETA.