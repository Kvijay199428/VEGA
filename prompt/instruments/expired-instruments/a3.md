Here’s a structured enterprise-grade user settings design for your expired instruments feature, including default settings, schema, and accessibility across CLI, REST, and frontend.

1. User Settings – Concept

User settings control how historical and expired instrument data is fetched and displayed without letting the user break system behavior. Settings are per-user and can be updated via REST, CLI, or frontend.

Key Principles

Scoped: Settings can be global (all forms) or local (session-specific).

Validated: Use schema validation to prevent invalid values.

Versioned: Keep default version for future upgrades.

Immutable core: Critical fields (like API keys) cannot be changed by users.

Extensible: Easy to add new options (intervals, caching, default expiry, etc.)

2. Settings Schema
{
  "user_id": "string",
  "preferences": {
    "default_expiry_fetch": "latest",        // "latest" or "all"
    "default_instrument_type": "options",   // "options" | "futures" | "both"
    "default_interval": "day",              // 1minute, 3minute, 5minute, 15minute, 30minute, day
    "auto_cache_expiries": true,            // Enable caching for expiry lists
    "auto_cache_contracts": true,           // Enable caching for contracts
    "max_historical_days": 365,             // Max days to fetch
    "show_weekly_options": true,            // Include weekly options
    "default_sector_filter": [],            // List of sector names
    "notification_email": null              // Optional email for alerts
  },
  "metadata": {
    "created_at": "2025-12-30T12:00:00+05:30",
    "updated_at": "2025-12-30T12:00:00+05:30",
    "version": "1.0"
  }
}

3. Default User Settings Pack
{
  "default_expiry_fetch": "latest",
  "default_instrument_type": "both",
  "default_interval": "day",
  "auto_cache_expiries": true,
  "auto_cache_contracts": true,
  "max_historical_days": 365,
  "show_weekly_options": true,
  "default_sector_filter": ["Nifty IT", "Nifty Bank", "Nifty Auto"],
  "notification_email": null
}


Notes:

Default sectors include commonly traded sectors; users can add/remove.

Defaults ensure system safety (limits to prevent excessive historical fetch).

4. Settings Access & Control
Interface	How to Access / Update
CLI	settings get, settings set key value
REST API	GET /user-settings, POST /user-settings
Frontend	Settings UI with toggles, dropdowns, multi-select
Backend / Scripts	Fetch via UserSettingsService.getSettings(userId)
5. Enterprise-grade Features

Role-based Settings: Only admin users can modify global defaults.

Validation: Enforce types, enums, date ranges, and intervals.

Persistence: Stored in central database or Redis + DB for fast retrieval.

Versioning: Allow upgrading default settings without breaking user overrides.

Audit Logging: Track every change for security and compliance.

Extensibility: Add new features like default_data_source or auto_fetch_new_sectors.

6. Sample Java Service for Settings
public interface UserSettingsService {
    
    UserSettings getSettings(String userId);
    
    void updateSettings(String userId, Map<String, Object> updates) throws ValidationException;
    
    void resetToDefault(String userId);
    
    void validateSettings(Map<String, Object> settings) throws ValidationException;
}

7. Example CLI Commands
# Get current settings
$ myapp settings get

# Update interval to 5 minutes
$ myapp settings set default_interval 5minute

# Enable weekly options display
$ myapp settings set show_weekly_options true

# Reset user to default settings
$ myapp settings reset

8. REST API Endpoints
Method	Path	Description
GET	/user-settings	Get current user settings
POST	/user-settings	Update specific settings
POST	/user-settings/reset	Reset to default pack
GET	/user-settings/default	Fetch default settings

Sample JSON Payload (POST /user-settings)

{
  "default_interval": "15minute",
  "default_sector_filter": ["Nifty IT", "Nifty Pharma"]
}