Below is a documentation-ready, regulator-safe, and implementation-aligned deliverable that completes all requested items in one coherent pack.
This is written so you can publish it internally or externally with minimal edits.

1. Developer Documentation (Authoritative)
1.1 System Purpose

This system provides deterministic, broker-agnostic resolution and risk-managed execution of cash and derivative instruments across NSE and BSE, supporting:

Multi-broker fan-out

Contract versioning

Exchange-specific expiry logic

RMS-enforced strike and quantity controls

Operator-safe override mechanisms

1.2 Core Components Overview
Component	Responsibility
Instrument Registry	Canonical instrument definitions
Broker Adapter	Broker-specific contract resolution
Symbol Mapping	Stable broker ↔ system mapping
Expiry Engine	Exchange-specific expiry calculation
RMS Engine	Pre-trade validation & rejection
Scheduler	T-1 pre-warm and refresh
Admin Controls	Strike / expiry / broker overrides
1.3 Contract Resolution Lifecycle

User order arrives

RMS validates:

Strike enabled

Quantity limits

User permissions

Resolver:

Uses expiry policy

Applies contract version

Resolves broker instrument

Order routed to broker adapter

No runtime broker calls are allowed during order placement.

1.4 Supported Exchanges & Segments
Exchange	Segments
NSE	EQ, FO (Index & Stock Options)
BSE	EQ, FO (Index Options only)
2. Admin UI Contracts (API-Level)

These contracts are frontend-agnostic (React, CLI, curl).

2.1 Disable Strike (Admin)
Endpoint
POST /admin/strikes/disable

Request
{
  "exchange": "NSE",
  "underlying_key": "NSE_INDEX|Nifty 50",
  "expiry": "2025-01-30",
  "strike": 22500,
  "option_type": "CE",
  "reason": "Illiquid / broker rejected"
}

Effect

Immediate RMS rejection

Audit logged

No deletion

2.2 Broker Priority Override
POST /admin/brokers/priority

{
  "instrument_type": "OPTION",
  "exchange": "BSE",
  "priority": ["ZERODHA", "UPSTOX"]
}

2.3 Contract Version Rollback
POST /admin/contracts/rollback

{
  "broker": "UPSTOX",
  "contract_version": 17,
  "reason": "Incorrect expiry mapping"
}

3. BSE Index Options Support (Formal)
3.1 Supported Indices
Index	Underlying Key
SENSEX	BSE_INDEX
BANKEX	BSE_INDEX
3.2 BSE Expiry Rules (Finalized)
Contract Type	Rule
Weekly	Every Thursday
Monthly	Last Thursday
Holiday	Shift to previous trading day
3.3 BSE Instrument Resolution
if (exchange == BSE && instrument.isIndexOption()) {
    expiry = bseExpiryPolicy.computeExpiry(...);
    strikeStep = index == SENSEX ? 100 : 50;
}

3.4 BSE-Specific RMS Rules
Rule	Value
Freeze Quantity	Broker-defined
Strike Gaps	Enforced
Weekly Auto-Disable	T+1 after expiry
4. User-Specific vs Admin-Specific Settings
4.1 Settings Design Principles

Immutable at runtime

Validated at load

Accessible via:

CLI

REST

Frontend

Hierarchical override:
System → Admin → User

4.2 User Settings (Safe Controls)
{
  "trading": {
    "allow_options": true,
    "allow_bse": false,
    "max_lot_per_order": 10,
    "max_orders_per_minute": 5
  },
  "risk": {
    "max_daily_loss": 50000,
    "require_rms_ack": true
  },
  "ui": {
    "default_exchange": "NSE",
    "confirm_before_place": true
  }
}

User cannot:

Change expiry

Enable disabled strikes

Override broker mapping

4.3 Admin Settings (High Authority)
{
  "expiry_engine": {
    "nse_weekly_day": "TUESDAY",
    "bse_weekly_day": "THURSDAY"
  },
  "rms": {
    "global_kill_switch": false,
    "max_system_exposure": 50000000
  },
  "brokers": {
    "priority": ["UPSTOX", "ZERODHA"],
    "fallback_enabled": true
  }
}

4.4 Settings Validation Matrix
Setting	User	Admin
Lot limits	✔	✔
Expiry rules	✖	✔
Broker priority	✖	✔
Strike disablement	✖	✔
Kill switch	✖	✔
5. Regulatory Audit Pack
5.1 Key Regulatory Guarantees
Requirement	Implementation
No retroactive edits	Versioned mappings
Audit trail	Append-only tables
Risk checks	Pre-trade RMS
Exchange compliance	Separate expiry engines
User protection	Immutable limits
5.2 Audit Tables (Must Retain)

broker_symbol_mapping

contract_version_history

disabled_strikes

rms_rejection_log

admin_actions_audit

Retention: 7 years minimum

5.3 Sample RMS Rejection Codes (Regulator-Friendly)
Code	Meaning
RMS-101	Strike disabled
RMS-102	Quantity exceeds freeze
RMS-103	Expired contract
RMS-201	User limit breach
RMS-301	Broker unavailable
5.4 Regulator Explanation (Plain English)

All derivative contracts are resolved before market hours, validated against exchange calendars, versioned immutably, and locked during live trading. No broker calls or contract changes occur during order placement.

6. Final Delivery Checklist

You now have:

Developer documentation

Admin API contracts

BSE index options support

User & admin settings model

Full regulatory audit readiness