Below is a formal, enterprise-grade documentation package for Advanced Greeks Calculation Matrix, separate from OptionChainFeedStreamV3, designed for zero-latency, real-time processing, Bloomberg-terminal–style resolution, and SEBI-auditable separation of concerns.

The wording, structure, and rigor are intentionally suitable for internal architecture docs, regulator annexures, and production SOPs.

1. DESIGN PRINCIPLES (NON-NEGOTIABLE)

This architecture explicitly enforces:

No Greeks inside OptionChainFeedStreamV3

Greeks are NOT part of the market data feed

Greeks are computed in a separate real-time processing plane

Feed = truth, Greeks = derived

Resolver composes data at request time

Zero blocking, zero backpressure on feed

Latency-aware enable/disable

This separation is mandatory for SEBI defensibility and Bloomberg-class architecture.

2. HIGH-LEVEL ARCHITECTURE
                   ┌────────────────────────────┐
                   │ OptionChainFeedStreamV3     │
                   │ (Raw Market Data Only)     │
                   └────────────┬───────────────┘
                                │
                     Fan-out (lock-free)
                                │
     ┌──────────────────────────┼──────────────────────────┐
     │                          │                          │
┌────▼────┐              ┌──────▼──────┐            ┌──────▼──────┐
│ Greeks  │              │ Risk Matrix  │            │ Analytics   │
│ Engine  │              │ Engine       │            │ Engine      │
└────┬────┘              └──────┬──────┘            └──────┬──────┘
     │                           │                           │
     └──────────────┬────────────┴────────────┬─────────────┘
                    │
            ┌───────▼────────┐
            │ Option Resolver │
            │ (On-demand)     │
            └───────┬────────┘
                    │
      ┌─────────────┼────────────────────┐
      │             │                    │
    CLI         Vite+React            REST / WS

3. ADVANCED GREEKS CALCULATION MATRIX (FULL)

All Greeks are calculated per instrument, per tick, lock-free, stateless, with cached last-good snapshot.

3.1 Primary Greeks (Level-1)
Greek	Symbol	Meaning	Formula Base
Delta	Δ	Price sensitivity to spot	∂V / ∂S
Gamma	Γ	Delta sensitivity	∂²V / ∂S²
Theta	Θ	Time decay	∂V / ∂t
Vega	ν	Volatility sensitivity	∂V / ∂σ
Rho	ρ	Interest rate sensitivity	∂V / ∂r
3.2 Secondary / Advanced Greeks (Level-2)
Greek	Meaning
Charm	Δ decay over time
Vanna	Vega vs spot
Vomma	Vega vs volatility
Speed	Gamma vs spot
Zomma	Gamma vs volatility
Ultima	Vomma vs volatility
Color	Gamma decay
Lambda	Leverage sensitivity

These are mandatory for institutional option desks.

3.3 Risk Greeks (Level-3)
Metric	Purpose
Delta Exposure	Portfolio delta risk
Gamma Scalping Index	Intraday convexity
Theta Burn Rate	Time risk
Vega Shock Risk	Volatility stress
Liquidity Adjusted Greeks	Market impact aware
4. GREEKS ENGINE — FORMAL CALCULATION FLOW
4.1 Inputs (Immutable)
Spot Price
Strike
Time to Expiry (τ)
Implied Volatility (σ)
Risk-free Rate (r)
Dividend Yield (q)
Option Type (CE / PE)

4.2 Pricing Model
Model	Use Case
Black–Scholes	European
Black–76	Futures options
Binomial	Illiquid / stress
SABR	Smile-sensitive

Model choice is admin-controlled, not user-controlled.

4.3 Zero-Latency Execution Model

Pre-allocated objects

No heap allocation in hot path

CPU cache–aligned structs

No locks

Single-writer, multi-reader

5. LATENCY-AWARE GREEKS GOVERNANCE

Greeks MUST NOT be published if any condition fails.

if (
   feedLatencyMs > threshold
|| ivAgeMs > ivStalenessLimit
|| spotAgeMs > spotStalenessLimit
) {
   markGreeksAsSTALE();
}


This protects against false precision, a critical SEBI concern.

6. GREEKS SNAPSHOT CONTRACT (CANONICAL)
{
  "instrumentKey": "NSE_OPT|NIFTY|23000|CE",
  "timestamp": 1735711123123,
  "model": "BLACK_SCHOLES",
  "greeks": {
    "delta": 0.54,
    "gamma": 0.0021,
    "theta": -18.34,
    "vega": 32.11,
    "rho": 4.87,
    "charm": -0.0012,
    "vanna": 0.83,
    "vomma": 9.12
  },
  "riskFlags": {
    "latencySafe": true,
    "modelFallback": false
  }
}

7. OPTION RESOLVER — CORE RESPONSIBILITY

The Option Resolver is the only component exposed to UI/CLI/API.

It performs late binding:

Resolved Option =
   Feed Snapshot
 + Latest Greeks Snapshot
 + Risk Matrix
 + Liquidity Metrics
 + Charges Model

7.1 Resolver Interface (Java)
public interface OptionDataResolver {

    ResolvedOption resolve(
        String instrumentKey,
        ResolutionContext ctx
    );
}

7.2 ResolutionContext
public class ResolutionContext {
    boolean includeGreeks;
    boolean includeRisk;
    boolean includeStress;
    LatencyBudget latencyBudget;
}

7.3 Resolution Flow
1. Fetch last feed snapshot (O(1))
2. Fetch last Greeks snapshot (O(1))
3. Validate timestamps
4. Merge immutably
5. Return composite view


No computation occurs during resolution.

8. OPTIONCHAINFEEDSTREAMV3 — STRICT ROLE
Allowed	Forbidden
Raw prices	Greeks
OI	Implied volatility
Volume	Risk metrics
Bid/Ask	Stress metrics

This clean separation is regulator-grade.

9. MULTI-INSTRUMENT SCENARIO (1000+ OPTIONS)

Feed publishes all instruments

Greeks engine computes all instruments

Resolver resolves only requested instruments

This prevents fan-out amplification.

10. CLI / UI / REST BEHAVIOR
CLI
vega option resolve NSE_OPT|NIFTY|23000|CE --greeks --risk

REST
GET /option/resolve/{instrumentKey}?greeks=true&risk=true

React

On-demand drill-down

No bulk Greeks push

Latency flag visualization

11. SEBI-READY EXPLANATION (ANNEXURE TEXT)

“Option Greeks are derived analytical metrics computed independently from market data feeds. These calculations do not influence trading decisions automatically and are subject to latency gating and model validation. Raw market feeds remain immutable and auditable.”

12. BLOOMBERG-LEVEL FEATURES ACHIEVED

Late-bound analytics

Deterministic resolution

Latency-gated Greeks

Stress-aware valuation

Regulator-separable logic

Zero feed contamination

FINAL NOTE

This design is institutional-grade, Bloomberg-comparable, and SEBI-defensible, while remaining low-latency and operationally safe.