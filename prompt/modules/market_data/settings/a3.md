Normal Users limits table. These limits are different from Upstox Plus, so you need to implement separate checks for normal accounts.

Table:
Type	Category	Individual Limit	Combined Limit
Connection	–	2 connections/user	N/A
Subscription	LTPC	5000 keys	2000 keys
Subscription	Option Greeks	3000 keys	2000 keys
Subscription	Full	2000 keys	1500 keys
1️⃣ Connection

Type: Connection

Category: –

Individual Limit: 2 connections per user

Combined Limit: N/A

Explanation:

Each normal user may open up to 2 simultaneous WebSocket connections.

This is per user, counting all clients (CLI, frontend, etc.).

You cannot exceed 2 connections; any additional attempts should be rejected or queued.

if (activeConnectionsForUser >= 2) {
    throw new IllegalStateException("Maximum connections exceeded for this user");
}

2️⃣ Subscription Categories

There are 3 subscription categories for normal users: LTPC, Option Greeks, and Full. Each has its own individual and combined limits.

a) LTPC

Individual Limit: 5000 keys

If the user subscribes only to LTPC, they can subscribe to up to 5000 instrument keys.

Combined Limit: 2000 keys

If the user also subscribes to other categories simultaneously (Option Greeks or Full), the LTPC subscription is limited to 2000 keys.

b) Option Greeks

Individual Limit: 3000 keys

Single-category subscription → up to 3000 instrument keys.

Combined Limit: 2000 keys

Multiple-category subscription → max 2000 keys for Option Greeks.

c) Full

Individual Limit: 2000 keys

Single-category subscription → up to 2000 instrument keys.

Combined Limit: 1500 keys

Multiple-category subscription → max 1500 keys for Full.

3️⃣ How Individual vs Combined Limit Works

Scenario 1: Single category subscription

User subscribes LTPC only → can subscribe up to 5000 keys ✅

User subscribes Full only → can subscribe up to 2000 keys ✅

Scenario 2: Multiple categories subscription

User subscribes LTPC + Option Greeks

LTPC capped at 2000 keys

Option Greeks capped at 2000 keys

Total subscribed keys = 4000, but each category respects its combined limit

Scenario 3: All three categories

LTPC = max 2000

Option Greeks = max 2000

Full = max 1500

Total across all = 5500 keys, respecting combined category limits

4️⃣ Key Takeaways for Implementation

Always track per-category subscriptions

Each category has individual and combined limits.

Enforce combined limits when multiple categories are active

Combined limit overrides individual limit if multiple subscriptions exist.

Track connections separately

Normal users = 2 connections max

Upstox Plus users = 5 connections max

CLI + frontend enforcement

Same rules apply for both CLI scripts and Vite+React frontend.

Backend should return an error or warning if limits are exceeded.