Let’s move on to the fourth module – Cancel Multi Order, keeping the enterprise-grade, industry-level standards, with user/admin settings, CLI, Vite+React integration, and audit best practices.

4. Cancel Multi Order – Enterprise Implementation Guide
Overview

The Cancel Multi Order API allows cancelling multiple orders in a single request. This is optimized for portfolio-level risk management, algorithmic strategies, or emergency market exits.

Key Features:

Batch cancel multiple orders across strategies.

Provides per-order success/failure feedback.

Supports filtering orders by user, strategy, or instrument.

Works seamlessly with Place Multi Order V2 and Cancel Order V3.

User/Admin-Centric Settings
User Settings

Access Token: Required for authorization.

Batch Cancellation Scope:

Filter orders by strategy tag, instrument, or user ID.

Select all open orders or specific batch via order_ids.

Risk Limits:

Max orders per batch.

Max cumulative order quantity/value.

Pre-Cancellation Validation:

Ensure no orders are in terminal states (TRADED, EXPIRED, CANCELLED).

Admin Settings

Rate-Limiting: Restrict max orders per batch to avoid API throttling.

Audit Logging:

Maintain before/after snapshots of every batch.

Log user, strategy, instrument, timestamp.

Retry Mechanism: Automatically retry failed cancellations.

Monitoring & Alerts:

Flag repeated cancellations from a single user.

Real-time notifications for failed orders.

API Request Structure

Endpoint:

DELETE /v3/order/cancel/multi
Sandbox: https://api-sandbox.upstox.com/v3/order/cancel/multi
Live: https://api.upstox.com/v3/order/cancel/multi
Authorization: Bearer <access_token>
Content-Type: application/json


Payload Example – Batch Cancel by Order IDs:

{
  "order_ids": ["1644490272000", "1644490272001", "1644490272002"]
}


Payload Example – Batch Cancel by Strategy Tag:

{
  "strategy_tag": "intraday_nifty",
  "status": "OPEN"
}


Payload Example – Batch Cancel All Open Orders for a User:

{
  "user_id": "user123",
  "status": "OPEN"
}

Response Structure

Success Example (HTTP 200):

{
  "status": "success",
  "data": [
    {"order_id": "1644490272000", "status": "CANCELLED"},
    {"order_id": "1644490272001", "status": "CANCELLED"},
    {"order_id": "1644490272002", "status": "CANCELLED"}
  ]
}


Partial Success Example:

{
  "status": "partial_success",
  "data": [
    {"order_id": "1644490272000", "status": "CANCELLED"},
    {"order_id": "1644490272002", "status": "FAILED", "error": "Order already TRADED"}
  ]
}


Error Example (HTTP 400):

{
  "status": "error",
  "error_code": "CANCEL_BATCH_NOT_ALLOWED",
  "message": "Batch size exceeds allowed maximum limit"
}

Enterprise Best Practices

Pre-Cancellation Checks

Validate orders for OPEN or PENDING states only.

Ensure compliance with user and strategy limits.

Partial Cancellation Handling

Track success/failure per order.

Retry only failed orders automatically.

Audit & Logging

Log batch before/after snapshots.

Record user, strategy tag, and timestamp for every order.

CLI Usage

# Cancel multiple orders by IDs
curl -X DELETE "https://api.upstox.com/v3/order/cancel/multi" \
-H "Authorization: Bearer $ACCESS_TOKEN" \
-H "Content-Type: application/json" \
-d '{"order_ids": ["1644490272000", "1644490272001"]}'

# Cancel all open orders for a strategy
curl -X DELETE "https://api.upstox.com/v3/order/cancel/multi" \
-H "Authorization: Bearer $ACCESS_TOKEN" \
-H "Content-Type: application/json" \
-d '{"strategy_tag": "intraday_nifty", "status": "OPEN"}'


Vite+React Integration

Use Axios.delete() with data payload for batch cancellation.

Maintain a real-time status map of orders (CANCELLED, FAILED, PENDING).

Highlight failed cancellations for immediate user attention.

Admin Dashboard

Display batch cancellation logs with timestamps.

Filter by user, strategy, instrument, or batch status.

Alert admins on repeated failures or abnormal cancellation spikes.

Security

Validate user roles and access permissions for batch cancellations.

Use HTTPS for all cancellation requests.

Enforce rate limits for automated or algorithmic strategies.

Recommended Enterprise Workflow

Retrieve all OPEN orders via Get Orders API.

Identify orders for batch cancellation using strategy tags, instruments, or user IDs.

Submit Cancel Multi Order request → Track responses per order.

Update frontend dashboard in real-time with cancellation statuses.

Log all batch cancellations in the audit system for compliance.