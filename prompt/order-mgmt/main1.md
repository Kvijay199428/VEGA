proceed with the implementation guide documentation for Place Multi Order V2, Modify Order V3, Cancel Order V3, Cancel Multi Order, Exit All Positiions, Get Order Details, Get Order History, Get Order Book, Get Trades, Get Order Trades, Get Trade History.
Place Multi Order Sandbox Enabled
This API extends the functionality of the Place Order API, allowing multiple orders to be placed simultaneously on the exchange. Each order in the request must include a unique correlation_id for individual tracking. Each successful order will return a unique order_id for further management such as modifications or cancellations.

A maximum of 25 orders can be placed in a single request. Any request exceeding this limit will be rejected. The Multi Order API is subject to a different rate limit compared to the standard limits applied across the system. For more information on the rate limits for this API, please check here.

Request
curl --location 'https://api.upstox.com/v2/order/multi/place' \
     --header 'Content-Type: application/json' \
     --header 'Accept: application/json' \
     --header 'Authorization: Bearer {your_access_token}' \
     --data '[
        {
            "correlation_id": "1",
            "quantity": 25,
            "product": "D",
            "validity": "DAY",
            "price": 0,
            "tag": "string",
            "instrument_token": "NSE_FO|62864",
            "order_type": "MARKET",
            "transaction_type": "BUY",
            "disclosed_quantity": 0,
            "trigger_price": 0,
            "is_amo": false,
            "slice": false
        },
        {
            "correlation_id": "2",
            "quantity": 25,
            "product": "D",
            "validity": "DAY",
            "price": 0,
            "tag": "string",
            "instrument_token": "NSE_FO|62867",
            "order_type": "MARKET",
            "transaction_type": "BUY",
            "disclosed_quantity": 0,
            "trigger_price": 0,
            "is_amo": false,
            "slice": false
        }
    ]'


Important
The is_amo flag in the order request will be ignored, and the system will automatically infer its value based on the current market session. If an order is placed during active trading hours, it will be processed as a live order regardless of whether is_amo: true was sent.

For additional samples in various languages, please refer to the Sample code section on this page.

Request Body
Name	Required	Type	Description
correlation_id	true	string	Uniquely identifies each order line within the request. It must be unique per line and is echoed in responses for easy tracking of related errors or feedback. The correlation_id must not exceed 20 characters in length.

Note: The correlation_id is scoped only to this request and cannot be used in another API to refer to this order line.
slice	false	boolean	When true, the number of orders is calculated based on the freeze quantity assigned for the instrument by the exchange. This helps automatically split the order into smaller parts in accordance with exchange rules, preventing rejection due to exceeding the allowed quantity. The default value is false. For a detailed explanation, please check the Auto Slicing section.
tag	false	string	This field functions the same as in the Place Order API, but with a size restriction of 40 characters.
For all other fields, please refer to the Place Order API documentation as all fields are the same as those used when placing an order using the Place Order API.


Order Execution Sequence
In a multi-order request, the system will execute all BUY orders first, followed by the execution of all SELL orders. This ensures a consistent and orderly processing of multiple order types within the same request.


Maximum Order Limit
When slicing is applied, we calculate the total number of resulting orders. The total number of orders in a request, including those generated by the slice, must not exceed the maximum order count specified here.


Responses
2XX
4XX
Response Body
Success (200)
Partial Success (207)
{
  "status": "success",
  "data": [
    {
      "correlation_id": "1",
      "order_id": "1644490272000"
    },
    {
      "correlation_id": "2",
      "order_id": "2134134141414"
    }
  ],
  "summary": {
    "total": 2,
    "payload_error": 0,
    "success": 2,
    "error": 0
  }
}

Name	Type	Description
status	string	A string indicating the outcome of the request.
Possible values: success, partial_success, error.

success - when all order lines were placed
partial_success - when some order lines encountered errors
error - when all order lines encountered errors or there were issues with one or more of the payloads.
data	object	Response data for place order request
data.correlation_id	string	Mirrors the unique identifier provided for each order line in the request, facilitating easy tracking and correlation of responses with their respective orders.
data.order_id	string	An order ID for the order request placed
summary	object	A summary of the outcomes for the batch of orders processed, detailing total orders, valid submissions, successful completions, and errors.
summary.total	integer	The total number of order lines present in the payload.
summary.payload_error	integer	The number of order lines with payload errors, indicating formatting or data validity issues.

Note: Orders are processed only if the entire batch is free of payload_error, ensuring error-free transactions.
summary.success	integer	The number of order lines that were successfully placed without any errors.
summary.error	integer	The number of order lines that encountered errors during processing, despite their payloads being valid.

Auto Slicing
Exchanges enforce a limitation on the maximum quantity that can be placed for any scrip, known as the freeze quantity. If an order exceeds this freeze quantity, it will be rejected by the exchange. To simplify the process and prevent such rejections, we automatically slice the order into smaller parts based on the freeze quantity defined by the exchange when necessary.

How to Enable Slicing
To enable this feature, include the slice field in your request payload with the value set to true. Let's walk through a practical example:

Suppose you want to place an order for SCRIP1 with a total quantity of 10,100, and the freeze quantity defined by the exchange is 1,000. If you send the slice field as false, the entire order is submitted to the exchange, which will reject it due to exceeding the allowed quantity. However, if you pass true as the value for the slice field, we automatically split the order into 11 smaller orders: 10 orders of 1,000 units each, and 1 order of 100 units. This ensures that all orders are accepted and processed by the exchange.

Correlation ID for Split Orders
In the case of a sliced order, the correlation_id will be returned with a suffix to uniquely identify each split order. For the use case defined above, if the correlation_id in the request was orderline25, the split orders will be returned with correlation_id values as orderline25_1, orderline25_2, and so on, up to orderline25_11. This allows for easy tracking and management of the split orders in subsequent operations or error handling.

Sample Code
Place a multi order
Curl
Python
Node.js
Java
PHP
Python SDK
Node.js SDK
Java SDK
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;

public class Main {

    public static void main(String[] args) {
        String url = "https://api.upstox.com/v2/order/multi/place";
        String token = "Bearer {your_access_token}";

        // Set up the request body with multiple orders
        String requestBody = "["
                + "{"
                + "\"correlation_id\": \"1\","
                + "\"quantity\": 25,"
                + "\"product\": \"D\","
                + "\"validity\": \"DAY\","
                + "\"price\": 0,"
                + "\"tag\": \"string\","
                + "\"instrument_token\": \"NSE_FO|62864\","
                + "\"order_type\": \"MARKET\","
                + "\"transaction_type\": \"BUY\","
                + "\"disclosed_quantity\": 0,"
                + "\"trigger_price\": 0,"
                + "\"is_amo\": false,"
                + "\"slice\": false"
                + "},"
                + "{"
                + "\"correlation_id\": \"2\","
                + "\"quantity\": 25,"
                + "\"product\": \"D\","
                + "\"validity\": \"DAY\","
                + "\"price\": 0,"
                + "\"tag\": \"string\","
                + "\"instrument_token\": \"NSE_FO|62867\","
                + "\"order_type\": \"MARKET\","
                + "\"transaction_type\": \"BUY\","
                + "\"disclosed_quantity\": 0,"
                + "\"trigger_price\": 0,"
                + "\"is_amo\": false,"
                + "\"slice\": false"
                + "}"
                + "]";

        // Create the HttpClient
        HttpClient httpClient = HttpClient.newHttpClient();

        // Create the HttpRequest
        HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(url))
                .header("Content-Type", "application/json")
                .header("Accept", "application/json")
                .header("Authorization", token)
                .POST(HttpRequest.BodyPublishers.ofString(requestBody))
                .build();

        try {
            // Send the request and retrieve the response
            HttpResponse<String> response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());

            // Print the response status code and body
            System.out.println("Response Code: " + response.statusCode());
            System.out.println("Response Body: " + response.body());

        } catch (Exception e) {
            // Handle exceptions
            e.printStackTrace();
        }
    }
}


Place Multiple BUY and SELL Orders
Curl
Python
Node.js
Java
PHP
Python SDK
Node.js SDK
Java SDK
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;

public class Main {

    public static void main(String[] args) {
        String url = "https://api.upstox.com/v2/order/multi/place";
        String token = "Bearer {your_access_token}";

        // Set up the request body with multiple orders
        String requestBody = "["
                + "{"
                + "\"correlation_id\": \"1\","
                + "\"quantity\": 25,"
                + "\"product\": \"D\","
                + "\"validity\": \"DAY\","
                + "\"price\": 0,"
                + "\"tag\": \"string\","
                + "\"instrument_token\": \"NSE_FO|62864\","
                + "\"order_type\": \"MARKET\","
                + "\"transaction_type\": \"BUY\","
                + "\"disclosed_quantity\": 0,"
                + "\"trigger_price\": 0,"
                + "\"is_amo\": false,"
                + "\"slice\": false"
                + "},"
                + "{"
                + "\"correlation_id\": \"2\","
                + "\"quantity\": 25,"
                + "\"product\": \"D\","
                + "\"validity\": \"DAY\","
                + "\"price\": 0,"
                + "\"tag\": \"string\","
                + "\"instrument_token\": \"NSE_FO|62867\","
                + "\"order_type\": \"MARKET\","
                + "\"transaction_type\": \"SELL\","
                + "\"disclosed_quantity\": 0,"
                + "\"trigger_price\": 0,"
                + "\"is_amo\": false,"
                + "\"slice\": false"
                + "}"
                + "]";

        // Create the HttpClient
        HttpClient httpClient = HttpClient.newHttpClient();

        // Create the HttpRequest
        HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(url))
                .header("Content-Type", "application/json")
                .header("Accept", "application/json")
                .header("Authorization", token)
                .POST(HttpRequest.BodyPublishers.ofString(requestBody))
                .build();

        try {
            // Send the request and retrieve the response
            HttpResponse<String> response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());

            // Print the response status code and body
            System.out.println("Response Code: " + response.statusCode());
            System.out.println("Response Body: " + response.body());

        } catch (Exception e) {
            // Handle exceptions
            e.printStackTrace();
        }
    }
}


Place Multiple Orders with Auto Slicing enabled
Curl
Python
Node.js
Java
PHP
Python SDK
Node.js SDK
Java SDK
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;

public class Main {

    public static void main(String[] args) {
        String url = "https://api.upstox.com/v2/order/multi/place";
        String token = "Bearer {your_access_token}";

        // Set up the request body with multiple orders
        String requestBody = "["
                + "{"
                + "\"correlation_id\": \"1\","
                + "\"quantity\": 2500000,"
                + "\"product\": \"D\","
                + "\"validity\": \"DAY\","
                + "\"price\": 0,"
                + "\"tag\": \"string\","
                + "\"instrument_token\": \"NSE_FO|62864\","
                + "\"order_type\": \"MARKET\","
                + "\"transaction_type\": \"BUY\","
                + "\"disclosed_quantity\": 0,"
                + "\"trigger_price\": 0,"
                + "\"is_amo\": false,"
                + "\"slice\": true"
                + "},"
                + "{"
                + "\"correlation_id\": \"2\","
                + "\"quantity\": 2500000,"
                + "\"product\": \"D\","
                + "\"validity\": \"DAY\","
                + "\"price\": 0,"
                + "\"tag\": \"string\","
                + "\"instrument_token\": \"NSE_FO|62867\","
                + "\"order_type\": \"MARKET\","
                + "\"transaction_type\": \"SELL\","
                + "\"disclosed_quantity\": 0,"
                + "\"trigger_price\": 0,"
                + "\"is_amo\": false,"
                + "\"slice\": true"
                + "}"
                + "]";

        // Create the HttpClient
        HttpClient httpClient = HttpClient.newHttpClient();

        // Create the HttpRequest
        HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(url))
                .header("Content-Type", "application/json")
                .header("Accept", "application/json")
                .header("Authorization", token)
                .POST(HttpRequest.BodyPublishers.ofString(requestBody))
                .build();

        try {
            // Send the request and retrieve the response
            HttpResponse<String> response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());

            // Print the response status code and body
            System.out.println("Response Code: " + response.statusCode());
            System.out.println("Response Body: " + response.body());

        } catch (Exception e) {
            // Handle exceptions
            e.printStackTrace();
        }
    }
}


POST /order/multi/place
Request
Sandbox URL
https://api-sandbox.upstox.com/v2
Live URL
https://api.upstox.com/v2
Authorization
Bearer
<your access token>
Body required
[
  {
    "correlation_id": "1",
    "quantity": 25,
    "product": "D",
    "validity": "DAY",
    "price": 0,
    "tag": "string",
    "instrument_token": "NSE_FO|62864",
    "order_type": "MARKET",
    "transaction_type": "BUY",
    "disclosed_quantity": 0,
    "trigger_price": 0,
    "is_amo": false,
    "slice": false
  },
  {
    "correlation_id": "2",
    "quantity": 25,
    "product": "D",
    "validity": "DAY",
    "price": 0,
    "tag": "string",
    "instrument_token": "NSE_FO|62867",
    "order_type": "MARKET",
    "transaction_type": "BUY",
    "disclosed_quantity": 0,
    "trigger_price": 0,
    "is_amo": false,
    "slice": false
  }
]
NOTE
In the event of payload issues with any order lines, the entire batch of orders will not be placed. Orders will only be executed when the entire array is validated and free of any payload_error. This ensures all transactions are processed without discrepancies.
The Multi order api is down for maintenance from 12:00 AM to 5:30 AM IST daily and is not available for usage during these hours. Users are advised to plan their activities accordingly.
Modify Order V3 Sandbox Enabled
API to modify an open or pending order. To perform a modification, the orderId is a required field. Along with the orderId, you should include any optional parameters that require modification. If no optional parameters are included in the modification request, the default values will be assumed from the original order.

Additionally this API includes latency information in the meta data object of the response, providing insight into the time Upstox took to process your request.

Request
curl --location --request PUT 'https://api-hft.upstox.com/v3/order/modify' \
--header 'Accept: application/json' \
--header 'Content-Type: application/json' \
--header 'Authorization: Bearer {your_access_token}' \
--data '{
  "quantity": 2,
  "validity": "DAY",
  "price": 16.8,
  "order_id": "240108010918222",
  "order_type": "LIMIT",
  "disclosed_quantity": 0,
  "trigger_price": 16.9
}'

For additional samples in various languages, please refer to the Sample code section on this page.


Request Body
Name	Required	Type	Description
quantity	false	integer (int32)	Quantity with which the order was placed
validity	true	string	Order validity (DAY- Day and IOC- Immediate or Cancel (IOC) order).
Possible values: DAY, IOC.
price	true	number (float)	Price at which the order was placed
order_id	true	string	The order ID for which the order must be modified. For the regex pattern applicable to this field, see the Field Pattern Appendix.
order_type	true	string	Type of order. It can be one of the following
MARKET refers to market order
LIMILT refers to Limit Order
SL refers to Stop Loss Limit
SL-M refers to Stop Loss Market.
Possible values: MARKET, LIMIT, SL, SL-M.
disclosed_quantity	false	integer (int32)	Indicates the volume to be displayed in the market depth. If provided, this value must be non-zero.
trigger_price	true	number (float)	If the order is a stop loss order then the trigger price to be set is mentioned here
Responses
200
4XX
Response Body
{
    "status": "success",
    "data": {
        "order_id": "1644490272000"
    },
    "metadata": {
        "latency": 40
    }
}

Name	Type	Description
status	string	A string indicating the outcome of the request. Typically success for successful operations.
data	object	Response data for modify order request
data.order_id	string	Order ID
metadata	object	Order metadata associated with successful order modified.
metadata.latency	integer	The overall time taken by API platform to process the order modification request, measured in milliseconds.

Sample Code
Modify a delivery order
Python
Node.js
Java
PHP
Python SDK
Node.js SDK
Java SDK
import java.io.OutputStream;
import java.net.HttpURLConnection;
import java.net.URL;

public class Main {

    public static void main(String[] args) {
        try {
            URL url = new URL("https://api-hft.upstox.com/v3/order/modify");
            HttpURLConnection connection = (HttpURLConnection) url.openConnection();

            connection.setRequestMethod("PUT");
            connection.setRequestProperty("Accept", "application/json");
            connection.setRequestProperty("Content-Type", "application/json");
            connection.setRequestProperty("Authorization", "Bearer {your_access_token}");

            connection.setDoOutput(true);

            String data = "{\"quantity\": 2, \"validity\": \"DAY\", \"price\": 16.8, \"order_id\": \"240108010918222\", \"order_type\": \"LIMIT\", \"disclosed_quantity\": 0, \"trigger_price\": 16.9}";

            try (OutputStream os = connection.getOutputStream()) {
                byte[] input = data.getBytes("utf-8");
                os.write(input, 0, input.length);
            }

            int responseCode = connection.getResponseCode();
            System.out.println("Response Code: " + responseCode);

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}


PUT /order/modify
Request
Sandbox URL
https://api-sandbox.upstox.com/v3
Live URL
https://api-hft.upstox.com/v3
Authorization
Bearer
<your access token>
Body required
{
  "quantity": 1,
  "validity": "DAY",
  "price": 120.01,
  "order_id": "1644490272000",
  "order_type": "MARKET",
  "disclosed_quantity": 0,
  "trigger_price": 0
}
Cancel Order V3 Sandbox Enabled
API to cancel an open or pending order which can be applied to both After Market Orders (AMO) and regular orders.

Additionally this API includes latency information in the meta data object of the response, providing insight into the time Upstox took to process your request.

Request
curl --location --request DELETE 'https://api-hft.upstox.com/v3/order/cancel?order_id=240108010445130' \
--header 'Content-Type: application/json' \
--header 'Accept: application/json' \
--header 'Authorization: Bearer {your_access_token}'


For additional samples in various languages, please refer to the Sample code section on this page.


Query Parameters
Name	Required	Type	Description
order_id	true	string	The order ID for which the order must be cancelled. For the regex pattern applicable to this field, see the Field Pattern Appendix.
Responses
200
4XX
Response Body
{
    "status": "success",
    "data": {
        "order_id": "1644490272000"
    },
    "metadata": {
        "latency": 30
    }
}

Name	Type	Description
status	string	A string indicating the outcome of the request. Typically success for successful operations.
data	object	Response data for Cancel order request
data.order_id	string	Reference order ID
metadata	object	Order metadata associated with successful cancelled order.
metadata.latency	integer	The overall time taken by API platform to process the order cancellation request, measured in milliseconds.

Sample Code
Cancel an open order
Python
Node.js
Java
PHP
Python SDK
Node.js SDK
Java SDK
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;


public class Main {

    public static void main(String[] args) throws Exception {
        String url = "https://api-hft.upstox.com/v3/order/cancel?order_id=240108010913262";

        // Replace with your actual values
        String contentTypeHeader = "application/json";
        String acceptHeader = "application/json";
        String authorizationHeader = "Bearer {your_access_token}";

        HttpClient client = HttpClient.newHttpClient();
        HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(url))
                .header("Content-Type", contentTypeHeader)
                .header("Accept", acceptHeader)
                .header("Authorization", authorizationHeader)
                .DELETE()
                .build();

        HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());

        System.out.println("Response Code: " + response.statusCode());
        System.out.println("Response Body: " + response.body());
    }
}


DELETE /order/cancel
Request
Sandbox URL
https://api-sandbox.upstox.com/v3
Live URL
https://api-hft.upstox.com/v3
Authorization
Bearer
<your access token>
order_id — query required
The order ID for which the order must be cancelled
Cancel Multi Order
Use this API to cancel all open orders in one go. You can filter by segment or tag to cancel specific orders, or cancel all open orders with a single request. This applies to both AMO and regular orders. The order_ids of the cancelled orders will be returned in the response.

A maximum of 50 orders can be cancelled in a single request. Any request exceeding this limit will be rejected. The Cancel Multi Order API is subject to a different rate limit compared to the standard limits applied across the system. For more information on the rate limits for this API, please check here.

Request
curl --location --request DELETE 'https://api.upstox.com/v2/order/multi/cancel' \
--header 'Content-Type: application/json' \
--header 'Accept: application/json' \
--header 'Authorization: Bearer {your_access_token}'

For additional samples in various languages, please refer to the Sample code section on this page.

Query Parameters
Name	Required	Type	Description
segment	false	string	The segment associated with the open orders.
Possible values: NSE_EQ, BSE_EQ, NSE_FO, BSE_FO, MCX_FO, NCD_FO, BCD_FO, NSE_COM.
tag	false	string	The tag associated with the open orders.

Responses
2XX
4XX
Response Body
Success (200)
Partial Success (207)
{
    "status": "success",
    "data": {
        "order_ids": [
            "1644490272000",
            "1644490272001",
            "1644490272003"
        ]
    },
    "errors": null,
    "summary": {
        "total": 3,
        "success": 3,
        "error": 0
    }
}

Name	Type	Description
status	string	A string indicating the outcome of the request. Possible values: success, partial_success, error.

success - when all the cancel order request are successful.
partial_success - when some cancel order request encountered errors.
error - when all the cancel order request encountered errors.
data	object	Successful response data for cancel multi order request.
data.order_ids	array	List of reference order IDs associated with successfully cancelled orders.
errors	array	An array containing the main content of the error response for partial_success and error scenarios.
errors[].error_code	string	A specific error code.
errors[].message	string	Descriptive error message.
errors[].property_path	string	Indicates which part of the request triggered the error. It can be null.
errors[].invalid_value	string	Shows the value causing the error. It can be null.
errors[].instrument_key	string	A Key of instrument for a specific order.
errors[].order_id	string	Order ID associated to specific order. It can be null.
summary	object	A summary of the outcomes for the batch of orders processed, detailing total orders, successful completions, and errors.
summary.total	integer	The total number of order present in the payload for cancel multi orders.
summary.success	integer	Indicates the successful cancelled orders.
summary.error	integer	Indicates the unsuccessful cancelled orders.

Sample Code
Cancel all the open orders
Curl
Python
Node.js
Java
PHP
Python SDK
Node.js SDK
Java SDK
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;


public class Main {

    public static void main(String[] args) throws Exception {
        String url = "https://api.upstox.com/v2/order/multi/cancel";

        // Replace with your actual values
        String acceptHeader = "application/json";
        String authorizationHeader = "Bearer {your_access_token}";

        HttpClient client = HttpClient.newHttpClient();
        HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(url))
                .header("Content-Type", "application/json")
                .header("Accept", acceptHeader)
                .header("Authorization", authorizationHeader)
                .DELETE()
                .build();

        HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());

        System.out.println("Response Code: " + response.statusCode());
        System.out.println("Response Body: " + response.body());
    }
}


Cancel all the open orders for a given segment
Curl
Python
Node.js
Java
PHP
Python SDK
Node.js SDK
Java SDK
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;


public class Main {

    public static void main(String[] args) throws Exception {
        String url = "https://api.upstox.com/v2/order/multi/cancel?segment=NSE_FO";

        // Replace with your actual values
        String acceptHeader = "application/json";
        String authorizationHeader = "Bearer {your_access_token}";

        HttpClient client = HttpClient.newHttpClient();
        HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(url))
                .header("Content-Type", "application/json")
                .header("Accept", acceptHeader)
                .header("Authorization", authorizationHeader)
                .DELETE()
                .build();

        HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());

        System.out.println("Response Code: " + response.statusCode());
        System.out.println("Response Body: " + response.body());
    }
}


Cancel all the open orders for a given tag
Curl
Python
Node.js
Java
PHP
Python SDK
Node.js SDK
Java SDK
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;


public class Main {

    public static void main(String[] args) throws Exception {
        String url = "https://api.upstox.com/v2/order/multi/cancel?tag=xyz";

        // Replace with your actual values
        String acceptHeader = "application/json";
        String authorizationHeader = "Bearer {your_access_token}";

        HttpClient client = HttpClient.newHttpClient();
        HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(url))
                .header("Content-Type", "application/json")
                .header("Accept", acceptHeader)
                .header("Authorization", authorizationHeader)
                .DELETE()
                .build();

        HttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());

        System.out.println("Response Code: " + response.statusCode());
        System.out.println("Response Body: " + response.body());
    }
}


DELETE /order/multi/cancel
Request
Live URL
https://api.upstox.com/v2
tag — query
The tag associated with the open orders.
segment — query
The segment associated with the open orders.
Exit All Positions
Use this API to exit all open positions in one go. You can filter by segment or tag to exit specific positions, or exit all open positions with a single request. The order_ids of the new orders created to square off will be returned in the response.

Request
curl --location --request POST 'https://api.upstox.com/v2/order/positions/exit' \
--header 'Content-Type: application/json' \
--header 'Accept: application/json' \
--header 'Authorization: Bearer {your_access_token}'

For additional samples in various languages, please refer to the Sample code section on this page.


Query Parameters
Name	Required	Type	Description
segment	false	string	The segment associated with the positions.
Possible values: NSE_EQ, BSE_EQ, NSE_FO, BSE_FO, MCX_FO, NCD_FO, BCD_FO, NSE_COM.
tag	false	string	The tag associated with the positions. Check the Understanding How the Order Tag Filter Works section for a detailed explanation on how filtering by order tag works.

Order Tag Scenario
An order tag is a feature that allows traders to categorize or label their orders for better tracking and management. However, it is important to note that order tags are only valid for intraday positions. They are specifically designed for trades that are opened and closed within the same trading session.

When a position is carried forward to the next trading day, the order tag associated with it becomes invalid or irrelevant. This is because carry-forwarded positions are no longer tied to the context of the original trading session where the tag was applied.

For carry-forward positions, use a general exit approach without filtering by tags.


Order Execution Sequence
The system will execute all BUY positions first, followed by the execution of all SELL orders. This ensures a consistent and orderly processing of multiple order types within the same request.


Maximum Position Limit
When slicing is applied, we calculate the total number of resulting orders. The total number of orders in a request, including those generated by the slice, must not exceed the maximum position count specified here.


Responses
2XX
4XX
Response Body
Success (200)
Partial Success (207)
{
    "status": "success",
    "data": {
        "order_ids": [
            "1644490272000",
            "1644490272001",
            "1644490272003"
        ]
    },
    "errors": null,
    "summary": {
        "total": 3,
        "success": 3,
        "error": 0
    }
}

Name	Type	Description
status	string	A string indicating the outcome of the request. Possible values: success, partial_success, error.

success - when all positions were exit successfully.
partial_success - when some positions encountered errors.
error - when all the positions encountered errors.
data	object	Successful response data for exit all positions request.
data.order_ids	array	List of reference order IDs associated with successful exit positions.
errors	array	An array containing the main content of the error response for partial_success and error scenarios.
errors[].error_code	string	A specific error code.
errors[].message	string	Descriptive error message.
errors[].property_path	string	Indicates which part of the request triggered the error. It can be null.
errors[].invalid_value	string	Shows the value causing the error. It can be null.
errors[].instrument_key	string	A Key of instrument for a specific position.
errors[].order_id	string	Order ID associated to specific position. It can be null.
summary	object	A summary of the outcomes for the batch of orders processed, detailing total orders, successful completions, and errors.
summary.total	integer	The total number of order present in the payload for exit positions.
summary.success	integer	Indicates the successful orders placed for exit positions.
summary.error	integer	Indicates the unsuccessful orders placed for exit positions.

Auto Slicing
Exchanges enforce a limitation on the maximum quantity that can be placed for any scrip, known as the freeze quantity. If an order exceeds this freeze quantity, it will be rejected by the exchange. To simplify the process and prevent such rejections, we automatically slice the order into smaller parts based on the freeze quantity defined by the exchange when necessary.

For example:
If you want to exit position for SCRIP1 with a total quantity of 10,100, and the freeze quantity defined by the exchange is 1,000, then the system will automatically split the position into 11 smaller for execution: 10 positions of 1,000 quantity each, and 1 position of 100 quantity. This ensures that all quantities are accepted and processed by the exchange.


Understanding How the Order Tag Filter Works
How Positions work
When you place multiple orders for the same instrument_key, your positions are aggregated based on the total quantity, not by individual orders. This means positions are not identifiable by specific order numbers.

What happens when you filter by Tag?
When you use the Exit Position API with a tag filter, the system identifies orders associated with that tag and calculates the total quantity for each instrument_key. It then creates a square-off order for that quantity to exit the position. Note that the square-off is performed based on quantity, not on individual orders.

Let's illustrate how this will work with an example:

Order 1: You buy 100 shares of ABC_CORP with the tag Strategy_A.
Order 2: You buy 50 shares of ABC_CORP with the tag Strategy_B.
Your position for ABC_CORP now shows a total of 150 shares.

Now, you decide to exit positions associated with Strategy_A:

You call the Exit All API with tag=Strategy_A.
The system identifies that Strategy_A is associated with ABC_CORP for 100 shares.
A square-off order is created to sell 100 shares of ABC_CORP.
Key Takeaway
When exiting positions using a tag filter, the system squares off based on total quantities per instrument, not individual orders or tags. Therefore, if you have multiple positions in the same instrument with different tags, exiting positions with a specific tag may impact your overall position in that instrument beyond the intended tag.


Sample Code
Exit all the open positions
Curl
Python
Node.js
Java
PHP
Python SDK
Node.js SDK
Java SDK
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;


public class Main {

    public static void main(String[] args) {
        String url = "https://api.upstox.com/v2/order/positions/exit";
        String token = "Bearer {your_access_token}";

        // empty request body
        String requestBody = "";

        // Create the HttpClient
        HttpClient httpClient = HttpClient.newHttpClient();

        // Create the HttpRequest
        HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(url))
                .header("Content-Type", "application/json")
                .header("Accept", "application/json")
                .header("Authorization", token)
                .POST(HttpRequest.BodyPublishers.ofString(requestBody))
                .build();

        try {
            // Send the request and retrieve the response
            HttpResponse<String> response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());

            // Print the response status code and body
            System.out.println("Response Code: " + response.statusCode());
            System.out.println("Response Body: " + response.body());

        } catch (Exception e) {
            // Handle exceptions
            e.printStackTrace();
        }
    }
}


Exit all the open positions for a given segment
Curl
Python
Node.js
Java
PHP
Python SDK
Node.js SDK
Java SDK
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;


public class Main {

    public static void main(String[] args) {
        String url = "https://api.upstox.com/v2/order/positions/exit?segment=NSE_FO";
        String token = "Bearer {your_access_token}";

        // empty request body
        String requestBody = "";

        // Create the HttpClient
        HttpClient httpClient = HttpClient.newHttpClient();

        // Create the HttpRequest
        HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(url))
                .header("Content-Type", "application/json")
                .header("Accept", "application/json")
                .header("Authorization", token)
                .POST(HttpRequest.BodyPublishers.ofString(requestBody))
                .build();

        try {
            // Send the request and retrieve the response
            HttpResponse<String> response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());

            // Print the response status code and body
            System.out.println("Response Code: " + response.statusCode());
            System.out.println("Response Body: " + response.body());

        } catch (Exception e) {
            // Handle exceptions
            e.printStackTrace();
        }
    }
}


Exit all the open positions for a given tag
Curl
Python
Node.js
Java
PHP
Python SDK
Node.js SDK
Java SDK
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;


public class Main {

    public static void main(String[] args) {
        String url = "https://api.upstox.com/v2/order/positions/exit?tag=xyz";
        String token = "Bearer {your_access_token}";

        // empty request body
        String requestBody = "";

        // Create the HttpClient
        HttpClient httpClient = HttpClient.newHttpClient();

        // Create the HttpRequest
        HttpRequest request = HttpRequest.newBuilder()
                .uri(URI.create(url))
                .header("Content-Type", "application/json")
                .header("Accept", "application/json")
                .header("Authorization", token)
                .POST(HttpRequest.BodyPublishers.ofString(requestBody))
                .build();

        try {
            // Send the request and retrieve the response
            HttpResponse<String> response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());

            // Print the response status code and body
            System.out.println("Response Code: " + response.statusCode());
            System.out.println("Response Body: " + response.body());

        } catch (Exception e) {
            // Handle exceptions
            e.printStackTrace();
        }
    }
}


POST /order/positions/exit
Request
Live URL
https://api.upstox.com/v2
Important
This API does not support exiting positions for Delivery orders in the EQ segment.
This API will place a opposite leg MARKET order for each position.
This API will be applicable during the market segment's trading hours.
Auto slicing is enabled by default for this API. Click here for more details.
Exit Positions Limits and Rate Limits
A maximum of 50 positions can be exit in a single request. Any request exceeding this limit will be rejected.
The Exit Positions API is subject to a different rate limit compared to the standard limits applied across the system. For more information on the rate limits for this API, please check here.
Rate Limits
In our pursuit of offering a consistent and reliable service, we've established rate limits for our API interactions. These constraints, detailed below, are designed to prevent system overloads and ensure equitable access to all our users. The rate limits are enforced on a per-API, per-user basis.

Order Placement and Other Standard APIs
Time duration	Request limit
Per second	50 requests
Per minute	500 requests
Per 30 minutes	2000 requests

Multi-Order APIs (Place, Cancel, and Exit Positions)
Time duration	Request limit
Per second	4 request
Per minute	40 requests
Per 30 minutes	160 requests
Get Order Details
API to retrieve the latest status of a specific order. Orders placed by the user remain available for one trading day and are automatically removed at the end of the trading session.

Request
curl --location 'https://api.upstox.com/v2/order/details?order_id=240108010445130' \
--header 'Content-Type: application/json' \
--header 'Accept: application/json' \
--header 'Authorization: Bearer {your_access_token}'

For additional samples in various languages, please refer to the Sample code section on this page.


Query Parameters
Name	Required	Type	Description
order_id	false	string	The order reference ID for which the order status is required. For the regex pattern applicable to this field, see the Field Pattern Appendix.
Responses
200
4XX
Response Body
{
  "status": "success",
  "data": {
    "exchange": "NSE",
    "product": "D",
    "price": 571.0,
    "quantity": 1,
    "status": "complete",
    "tag": null,
    "instrument_token": "NSE_EQ|INE062A01020",
    "placed_by": "******",
    "trading_symbol": "SBIN-EQ",
    "tradingsymbol": "SBIN-EQ",
    "order_type": "LIMIT",
    "validity": "DAY",
    "trigger_price": 0.0,
    "disclosed_quantity": 0,
    "transaction_type": "BUY",
    "average_price": 570.95,
    "filled_quantity": 1,
    "pending_quantity": 0,
    "status_message": null,
    "status_message_raw": null,
    "exchange_order_id": "1300000025660919",
    "parent_order_id": null,
    "order_id": "231019025562880",
    "variety": "SIMPLE",
    "order_timestamp": "2023-10-19 13:25:13",
    "exchange_timestamp": "2023-10-19 13:25:13",
    "is_amo": false,
    "order_request_id": "1",
    "order_ref_id": "GTT-C23191000044253"
  }
}

Name	Type	Description
status	string	A string indicating the outcome of the request. Typically success for successful operations.
data	object	Response data for order Book
data.exchange	string	Exchange to which the order is associated. Valid exchanges can be found in the Exchange Appendix
data.product	string	Signifies if the order was either Intraday, Delivery or CO.
Possible values: I, D, CO, MTF.
data.price	float	Price at which the order was placed
data.quantity	int32	Quantity with which the order was placed
data.status	string	Indicates the current status of the order. Valid order statuses can be found in the Order Status Appendix
data.tag	string	Tag to uniquely identify an order
data.instrument_token	string	Key of the instrument. For the regex pattern applicable to this field, see the Field Pattern Appendix.
data.placed_by	string	Uniquely identifies the user (commonly referred as UCC)
data.trading_symbol	string	Shows the trading symbol of the instrument
data.order_type	string	Type of order. It can be one of the following MARKET refers to market order LIMIT refers to Limit Order SL refers to Stop Loss Limit SL-M refers to Stop Loss Market.
Possible values: MARKET, LIMIT, SL, SL-M.
data.validity	string	It can be one of the following - DAY(default), IOC.
Possible values: DAY, IOC.
data.trigger_price	float	If the order was a stop loss order then the trigger price set is mentioned here
data.disclosed_quantity	int32	The quantity that should be disclosed in the market depth
data.transaction_type	string	Indicates whether its a buy or sell order.
Possible values: BUY, SELL.
data.average_price	float	Average price at which the qty got traded
data.filled_quantity	int32	The total quantity traded from this particular order
data.pending_quantity	int32	Pending quantity to be filled
data.status_message	string	Indicates the reason when any order is rejected, not modified or cancelled
data.status_message_raw	string	Description of the order's status as received from RMS
data.exchange_order_id	string	Unique order ID assigned by the exchange for the order placed
data.parent_order_id	string	In case the order is part of the second of a CO, the parent order ID is indicated here
data.order_id	string	Unique order ID assigned internally for the order placed
data.variety	string	Order complexity
data.order_timestamp	string	User readable timestamp at which the order was placed
data.exchange_timestamp	string	User readable time at which the order was placed or updated
data.is_amo	boolean	Signifies if the order is an After Market Order
data.order_request_id	string	Apart from 1st order it shows the count of how many requests were sent
data.order_ref_id	string	Uniquely identifies an order for internal usage.

Sample Code
Get order details for an order number
Python
Node.js
Java
PHP
Python SDK
Node.js SDK
Java SDK
import java.net.URI;
import java.net.http.HttpClient;
import java.net.http.HttpRequest;
import java.net.http.HttpResponse;
import java.util.Map;

public class Main {
    public static void main(String[] args) {
        String url = "https://api.upstox.com/v2/order/details";
        String accept = "application/json";
        String authorization = "Bearer {your_access_token}";
        String orderId = "240108010445130";

        try {
            HttpClient httpClient = HttpClient.newHttpClient();

            // Build the URI with query parameters
            URI uri = URI.create(url + "?order_id=" + orderId);

            // Build the request
            HttpRequest request = HttpRequest.newBuilder()
                    .uri(uri)
                    .header("Content-Type", "application/json")
                    .header("Accept", accept)
                    .header("Authorization", authorization)
                    .GET()
                    .build();

            // Send the request and get the response
            HttpResponse<String> response = httpClient.send(request, HttpResponse.BodyHandlers.ofString());

            // Print the response
            System.out.println("Response Code: " + response.statusCode());
            System.out.println("Response: " + response.body());
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}


GET /order/details
Request
Live URL
https://api.upstox.com/v2
order_id — query
The order reference ID for which the order status is required
