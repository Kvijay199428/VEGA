# VEGA Trader Backend Configuration

# Server - Port 28021 dedicated to MarketDataStreamerV3
server.port=28020
# server.servlet.context-path=/api

# Application
spring.application.name=vega-trader

# Timezone Configuration (IST - Indian Standard Time)
application.timezone=Asia/Kolkata
spring.jackson.time-zone=Asia/Kolkata

# Database (SQLite)
spring.datasource.url=jdbc:sqlite:database/vega_trade.db
spring.datasource.driver-class-name=org.sqlite.JDBC
spring.jpa.database-platform=org.hibernate.community.dialect.SQLiteDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false

# Flyway Configuration (SQLite)
spring.flyway.enabled=false
spring.flyway.baseline-on-migrate=true
spring.flyway.locations=classpath:db/migration

# Instrument Refresh Configuration
instrument.refresh.enabled=true
instrument.refresh.auto-start=false

# Logging
logging.level.root=INFO
logging.level.com.vegatrader=DEBUG
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# Market Data Streamer V3 Logging
logging.file.name=d:/projects/VEGA TRADER/prompt/upstox_endpoints/market_data_feed_v3/log/ws.log
logging.file.max-size=10MB
logging.file.max-history=7

# Cache Configuration
spring.cache.type=caffeine
spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=60s

# JWT Configuration
jwt.secret=your-256-bit-secret-key-for-jwt-tokens-minimum-32-chars
jwt.expiration=86400000

# Upstox API Configuration
upstox.base-url=https://api.upstox.com/v2
upstox.auth-url=https://api.upstox.com/v2/login/authorization/dialog
upstox.token-url=https://api.upstox.com/v2/login/authorization/token
upstox.redirect-uri=http://localhost:28020/api/v1/auth/upstox/callback

# Market Data
market.fetch-interval-seconds=1
market.cache-ttl-seconds=30

# Option Chain
optionchain.fetch-interval-seconds=3
optionchain.cache-ttl-seconds=60

# Valuation
valuation.risk-free-rate=0.07
valuation.overvalued-threshold-pct=5.0
valuation.currency-symbol=â‚¹

# CORS
cors.allowed-origins=http://localhost:3000,http://localhost:5173,http://localhost:28021

# MarketDataStreamerV3 Configuration
market-data-streamer.enabled=true
market-data-streamer.auto-start=false

# PortfolioDataStreamerV2 Configuration
portfolio-streamer.enabled=true
portfolio-streamer.update-types=order,position,holding

# Actuator Endpoints
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=when-authorized
management.endpoint.prometheus.enabled=true

# Disable Redis health check (Redis is optional)
management.health.redis.enabled=false
spring.data.redis.repositories.enabled=false

# Metrics Configuration
management.metrics.tags.application=vega-trader
management.metrics.tags.service=upstox-streamer
management.metrics.enable.all=true

# Prometheus scraping endpoint
management.prometheus.metrics.export.enabled=true

# Market Data Settings
marketdata.enabled=true
marketdata.auto-start=false
marketdata.reconnect-delay-ms=5000
marketdata.max-batch-size=1000
marketdata.buffer-capacity=50000
marketdata.metrics-enabled=true

# Connection Limits
marketdata.connection-limits.normal=2
marketdata.connection-limits.plus=5

# Subscription Limits - Normal Users
marketdata.subscription-limits.LTPC.individual=5000
marketdata.subscription-limits.LTPC.combined=2000
marketdata.subscription-limits.OptionGreeks.individual=3000
marketdata.subscription-limits.OptionGreeks.combined=2000
marketdata.subscription-limits.Full.individual=2000
marketdata.subscription-limits.Full.combined=1500

# Subscription Limits - Upstox Plus
marketdata.subscription-limits.FullD30.individual=50
marketdata.subscription-limits.FullD30.combined=1500

# API Rate Limits (Guava RateLimiter)
api.ratelimiter.standard.rate=50
# Auto Login Configuration (provide via environment variables or leave empty)
upstox.auth.auto.username=${UPSTOX_MOBILE_NUMBER:}
upstox.auth.auto.password=${UPSTOX_PIN:}
upstox.auth.auto.totp-secret=${UPSTOX_TOTP:}
# Client IDs now discovered dynamically from UPSTOX_CLIENT_ID_0 through UPSTOX_CLIENT_ID_N
